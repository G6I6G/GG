<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Discord Voice Concierge</title>
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <header class="hero">
    <div>
      <p class="eyebrow">Flask + Discord.py</p>
      <h1>Генерация приватных голосовых приглашений</h1>
      <p class="lead">Создайте приватный голосовой канал, отправьте персональное приглашение и позвольте боту следить за очисткой и доступом.</p>
      <div class="badges">
        <span class="badge">Видимый канал</span>
        <span class="badge">Доступ только по приглашению</span>
        <span class="badge">Авто-удаление</span>
      </div>
    </div>
    <div class="callout">
      <h3>Как это работает</h3>
      <ol>
        <li>Заполните форму: ID сервера, ID пользователя и название канала.</li>
        <li>Бот создаст голосовой канал с ограничением по подключению.</li>
        <li>Пользователь получит DM с кнопкой принятия и ссылкой для входа.</li>
        <li>Когда приглашённые уйдут или не примут приглашение вовремя, канал удаляется.</li>
      </ol>
    </div>
  </header>

  <main class="grid">
    <section class="panel">
      <div class="panel-header">
        <div>
          <p class="eyebrow">Управление приглашениями</p>
          <h2>Отправить новое приглашение</h2>
        </div>
        <div class="helper">Токен бота читается из переменной окружения <code>DISCORD_BOT_TOKEN</code>.</div>
      </div>

      <form id="invite-form" class="form">
        <label class="field">
          <span>Server ID (Guild)</span>
          <input id="guild-id" name="guild_id" type="text" inputmode="numeric" placeholder="123456789012345678" required />
        </label>
        <label class="field">
          <span>Target User ID</span>
          <input id="user-id" name="user_id" type="text" inputmode="numeric" placeholder="987654321098765432" required />
        </label>
        <label class="field">
          <span>Название голосового канала</span>
          <input id="channel-name" name="channel_name" type="text" maxlength="80" placeholder="Комната совещаний" required />
        </label>
        <label class="field inline">
          <div>
            <span>Минут до истечения</span>
            <small>По умолчанию 30 минут</small>
          </div>
          <input id="expires-in" name="expires_in" type="number" min="1" max="240" value="30" />
        </label>

        <div class="actions">
          <button type="submit">Отправить приглашение</button>
          <button id="reset-form" type="button" class="ghost">Очистить форму</button>
        </div>
      </form>

      <div class="status" id="status" role="status" aria-live="polite"></div>
    </section>

    <section class="panel secondary">
      <div class="panel-header">
        <p class="eyebrow">Состояние бота</p>
        <h2>Подсказки</h2>
      </div>
      <ul class="tips">
        <li>Канал создаётся с видимостью для всех, но с запретом на подключение по умолчанию.</li>
        <li>При нажатии на кнопку в DM бот выдаёт точечное разрешение на подключение и отправляет уникальную ссылку.</li>
        <li>Когда канал пуст или время приглашения истекло, бот удалит канал и очистит его из списка.</li>
        <li>Если у пользователя закрыты личные сообщения, бот зафиксирует ошибку и вернёт её в ответе API.</li>
      </ul>
    </section>
  </main>

  <footer class="footer">
    <p>Запустите <code>python app.py</code> после установки зависимостей. Flask обслуживает эту страницу, а Discord-бот работает в фоновом потоке.</p>
  </footer>

  <script type="module" src="/src/main.js"></script>
</body>
</html>
